<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Stockfish Workers</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-box { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
        .success { background-color: #d4edda; }
        .error { background-color: #f8d7da; }
        .loading { background-color: #fff3cd; }
    </style>
</head>
<body>
    <h1>Stockfish Worker Tests</h1>
    
    <div id="test1" class="test-box loading">
        <h3>Test 1: Ultra Simple Worker</h3>
        <p id="test1-status">Testing...</p>
    </div>
    
    <div id="test2" class="test-box loading">
        <h3>Test 2: Working Worker</h3>
        <p id="test2-status">Testing...</p>
    </div>
    
    <div id="test3" class="test-box loading">
        <h3>Test 3: CDN Direct</h3>
        <p id="test3-status">Testing...</p>
    </div>

    <script>
        console.log('ðŸ§ª Starting Stockfish worker tests...');
        
        // Test 1: Ultra Simple Worker
        try {
            const worker1 = new Worker('/ultra-simple-stockfish-worker.js');
            let test1Ready = false;
            
            worker1.onmessage = (e) => {
                console.log('Test 1 message:', e.data);
                if (e.data.includes && e.data.includes('readyok')) {
                    test1Ready = true;
                    document.getElementById('test1').className = 'test-box success';
                    document.getElementById('test1-status').textContent = 'SUCCESS: Ultra simple worker ready!';
                }
            };
            
            worker1.onerror = (error) => {
                console.error('Test 1 error:', error);
                document.getElementById('test1').className = 'test-box error';
                document.getElementById('test1-status').textContent = 'ERROR: ' + error.message;
            };
            
            worker1.postMessage('uci');
            
            setTimeout(() => {
                if (!test1Ready) {
                    document.getElementById('test1').className = 'test-box error';
                    document.getElementById('test1-status').textContent = 'TIMEOUT: No response in 5 seconds';
                }
            }, 5000);
            
        } catch (error) {
            console.error('Test 1 failed to start:', error);
            document.getElementById('test1').className = 'test-box error';
            document.getElementById('test1-status').textContent = 'FAILED TO START: ' + error.message;
        }
        
        // Test 2: Working Worker
        try {
            const worker2 = new Worker('/working-stockfish-worker.js');
            let test2Ready = false;
            
            worker2.onmessage = (e) => {
                console.log('Test 2 message:', e.data);
                if ((e.data.type === 'ready') || (typeof e.data === 'string' && e.data.includes('readyok'))) {
                    test2Ready = true;
                    document.getElementById('test2').className = 'test-box success';
                    document.getElementById('test2-status').textContent = 'SUCCESS: Working worker ready!';
                }
            };
            
            worker2.onerror = (error) => {
                console.error('Test 2 error:', error);
                document.getElementById('test2').className = 'test-box error';
                document.getElementById('test2-status').textContent = 'ERROR: ' + error.message;
            };
            
            worker2.postMessage('uci');
            
            setTimeout(() => {
                if (!test2Ready) {
                    document.getElementById('test2').className = 'test-box error';
                    document.getElementById('test2-status').textContent = 'TIMEOUT: No response in 5 seconds';
                }
            }, 5000);
            
        } catch (error) {
            console.error('Test 2 failed to start:', error);
            document.getElementById('test2').className = 'test-box error';
            document.getElementById('test2-status').textContent = 'FAILED TO START: ' + error.message;
        }
        
        // Test 3: CDN Direct
        try {
            const worker3 = new Worker('https://cdn.jsdelivr.net/npm/stockfish@16/stockfish.min.js');
            let test3Ready = false;
            
            worker3.onmessage = (e) => {
                console.log('Test 3 message:', e.data);
                if (e.data.includes && e.data.includes('readyok')) {
                    test3Ready = true;
                    document.getElementById('test3').className = 'test-box success';
                    document.getElementById('test3-status').textContent = 'SUCCESS: CDN worker ready!';
                }
            };
            
            worker3.onerror = (error) => {
                console.error('Test 3 error:', error);
                document.getElementById('test3').className = 'test-box error';
                document.getElementById('test3-status').textContent = 'ERROR: ' + error.message;
            };
            
            worker3.postMessage('uci');
            
            setTimeout(() => {
                if (!test3Ready) {
                    document.getElementById('test3').className = 'test-box error';
                    document.getElementById('test3-status').textContent = 'TIMEOUT: No response in 5 seconds';
                }
            }, 5000);
            
        } catch (error) {
            console.error('Test 3 failed to start:', error);
            document.getElementById('test3').className = 'test-box error';
            document.getElementById('test3-status').textContent = 'FAILED TO START: ' + error.message;
        }
    </script>
</body>
</html>
